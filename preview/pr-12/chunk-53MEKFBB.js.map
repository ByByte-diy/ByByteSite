{
  "version": 3,
  "sources": ["src/app/services/router.service.ts"],
  "sourcesContent": ["import { Injectable, inject } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { TranslateService } from '@ngx-translate/core';\nimport { environment } from '../../environments/environment';\nimport { getLangFromPath, isValidLanguage } from '../utils/lang.utils';\n\n/**\n * Service for generating routes with language prefix\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class RouterService {\n  private readonly router = inject(Router);\n  private readonly translate = inject(TranslateService);\n\n  /**\n   * Get current language from URL or TranslateService\n   */\n  getCurrentLang(): string {\n    const currentUrl = this.router.url;\n    const urlLang = getLangFromPath(currentUrl);\n\n    // If URL explicitly contains a language prefix, use it\n    if (currentUrl.startsWith(`/${urlLang}/`) || currentUrl === `/${urlLang}`) {\n      return urlLang;\n    }\n\n    // Otherwise, fallback to TranslateService or default\n    return (\n      this.translate.getCurrentLang() || this.translate.getFallbackLang() || environment.defaultLang\n    );\n  }\n\n  /**\n   * Generate route with language prefix\n   * @param path Route path (e.g., '/build', '/learn')\n   * @param lang Optional language code. If not provided, uses current language\n   * @returns Route with language prefix (e.g., '/en/build')\n   */\n  getLocalizedRoute(path: string, lang?: string): string {\n    const targetLang = lang || this.getCurrentLang();\n\n    // Remove leading slash if present\n    const cleanPath = path.startsWith('/') ? path.slice(1) : path;\n\n    // If path is empty, return just language\n    if (!cleanPath) {\n      return `/${targetLang}`;\n    }\n\n    return `/${targetLang}/${cleanPath}`;\n  }\n\n  /**\n   * Navigate to route with language prefix\n   * @param path Route path\n   * @param lang Optional language code\n   */\n  navigateTo(path: string, lang?: string): void {\n    const route = this.getLocalizedRoute(path, lang);\n    this.router.navigate([route]);\n  }\n\n  /**\n   * Switch language and navigate to current route with new language\n   * @param lang Language code to switch to\n   */\n  switchLanguage(lang: string): void {\n    if (!isValidLanguage(lang)) {\n      console.error(`Invalid language: ${lang}`);\n      return;\n    }\n\n    // Get current route without language prefix\n    const currentUrl = this.router.url;\n    const urlLang = getLangFromPath(currentUrl);\n    const segments = currentUrl.split('/').filter(Boolean);\n\n    // Remove language prefix if present\n    let path = '';\n    if (segments.length > 0 && segments[0] === urlLang) {\n      path = '/' + segments.slice(1).join('/');\n    } else {\n      path = currentUrl || '/';\n    }\n\n    // Clean up path\n    if (path === '/' || path === '') {\n      path = '';\n    } else if (!path.startsWith('/')) {\n      path = '/' + path;\n    }\n\n    // Update language in TranslateService\n    this.translate.use(lang);\n\n    // Update localStorage\n    try {\n      localStorage.setItem('app-lang', lang);\n    } catch {}\n\n    // Navigate to new route with new language\n    const newRoute = this.getLocalizedRoute(path, lang);\n    this.router.navigate([newRoute]);\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;AAAA;AACA;;AAWM,IAAO,gBAAP,MAAO,eAAa;EACP,SAAS,OAAO,MAAM;EACtB,YAAY,OAAO,gBAAgB;;;;EAKpD,iBAAc;AACZ,UAAM,aAAa,KAAK,OAAO;AAC/B,UAAM,UAAU,gBAAgB,UAAU;AAG1C,QAAI,WAAW,WAAW,IAAI,OAAO,GAAG,KAAK,eAAe,IAAI,OAAO,IAAI;AACzE,aAAO;IACT;AAGA,WACE,KAAK,UAAU,eAAc,KAAM,KAAK,UAAU,gBAAe,KAAM,YAAY;EAEvF;;;;;;;EAQA,kBAAkB,MAAc,MAAa;AAC3C,UAAM,aAAa,QAAQ,KAAK,eAAc;AAG9C,UAAM,YAAY,KAAK,WAAW,GAAG,IAAI,KAAK,MAAM,CAAC,IAAI;AAGzD,QAAI,CAAC,WAAW;AACd,aAAO,IAAI,UAAU;IACvB;AAEA,WAAO,IAAI,UAAU,IAAI,SAAS;EACpC;;;;;;EAOA,WAAW,MAAc,MAAa;AACpC,UAAM,QAAQ,KAAK,kBAAkB,MAAM,IAAI;AAC/C,SAAK,OAAO,SAAS,CAAC,KAAK,CAAC;EAC9B;;;;;EAMA,eAAe,MAAY;AACzB,QAAI,CAAC,gBAAgB,IAAI,GAAG;AAC1B,cAAQ,MAAM,qBAAqB,IAAI,EAAE;AACzC;IACF;AAGA,UAAM,aAAa,KAAK,OAAO;AAC/B,UAAM,UAAU,gBAAgB,UAAU;AAC1C,UAAM,WAAW,WAAW,MAAM,GAAG,EAAE,OAAO,OAAO;AAGrD,QAAI,OAAO;AACX,QAAI,SAAS,SAAS,KAAK,SAAS,CAAC,MAAM,SAAS;AAClD,aAAO,MAAM,SAAS,MAAM,CAAC,EAAE,KAAK,GAAG;IACzC,OAAO;AACL,aAAO,cAAc;IACvB;AAGA,QAAI,SAAS,OAAO,SAAS,IAAI;AAC/B,aAAO;IACT,WAAW,CAAC,KAAK,WAAW,GAAG,GAAG;AAChC,aAAO,MAAM;IACf;AAGA,SAAK,UAAU,IAAI,IAAI;AAGvB,QAAI;AACF,mBAAa,QAAQ,YAAY,IAAI;IACvC,QAAQ;IAAC;AAGT,UAAM,WAAW,KAAK,kBAAkB,MAAM,IAAI;AAClD,SAAK,OAAO,SAAS,CAAC,QAAQ,CAAC;EACjC;;qCA7FW,gBAAa;EAAA;4EAAb,gBAAa,SAAb,eAAa,WAAA,YAFZ,OAAM,CAAA;;;sEAEP,eAAa,CAAA;UAHzB;WAAW;MACV,YAAY;KACb;;;",
  "names": []
}
