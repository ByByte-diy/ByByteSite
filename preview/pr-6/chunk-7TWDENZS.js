import{Da as S,G as T,Ha as a,Ia as K,Pa as w,Qa as L,Ua as O,db as M,gb as p,hb as I,ib as C,kb as G,lb as F,p as m,t as u,u as f}from"./chunk-6ZYCMACE.js";import{c as b,h as j}from"./chunk-ASRB7XND.js";S();O();K();S();var $=class c{meta=u(w);title=u(L);translate=u(M);platformId=u(T);injector=u(f);get siteName(){return p.siteName}get siteUrl(){return p.siteUrl}get siteDescription(){return p.siteDescription}updateSeoMeta(t){this.title.setTitle(t.title),this.updateMetaTag("description",t.description),this.updateMetaTag("keywords",t.keywords),this.updateMetaTag("author",t.author),this.updateMetaTag("og:title",t.openGraph?.title||t.title,"property"),this.updateMetaTag("og:description",t.openGraph?.description||t.description,"property"),this.updateMetaTag("og:image",t.openGraph?.image||t.image,"property"),this.updateMetaTag("og:url",t.openGraph?.url||t.url,"property"),this.updateMetaTag("og:type",t.openGraph?.type||t.type,"property"),this.updateMetaTag("og:site_name",t.openGraph?.siteName||t.siteName,"property"),this.updateMetaTag("og:locale",t.openGraph?.locale||t.locale,"property"),this.updateMetaTag("twitter:card",t.twitterCard),this.updateMetaTag("twitter:site",t.twitterSite),this.updateMetaTag("twitter:creator",t.twitterCreator),this.updateMetaTag("twitter:title",t.title),this.updateMetaTag("twitter:description",t.description),this.updateMetaTag("twitter:image",t.image),t.structuredData&&a(this.platformId)&&this.updateStructuredData(t.structuredData)}getTranslationFromStore(t,r){if(a(this.platformId))return null;try{let e=this.translate.store;if(!e?.translations?.[r])return null;let i=e.translations[r],n=t.split("."),s=i;for(let g of n)if(s=s?.[g],s==null)return null;return s}catch{return null}}getTranslationValue(t,r){let e=this.translate.instant(t);if(e===t&&!a(this.platformId)){let i=this.getCurrentLanguage(),n=this.getTranslationFromStore(t,i);n!==null&&(e=n)}return e===t||!e?r!==void 0?r:t:typeof e=="string"?e:r!==void 0?r:t}parseStructuredData(t,r){if(!(!t||t===r)){if(typeof t=="object")return t;if(typeof t=="string")try{return JSON.parse(t)}catch{return}}}updateSeoFromConfig(t,r){let e=this.getCurrentLanguage(),i=t.titleKey||"seo.home.title",n=t.descriptionKey||"seo.home.description",s=t.keywordsKey||"seo.home.keywords",g=t.imageKey||"seo.home.image",o=t.structuredDataKey||"seo.home.structuredData",l=this.getTranslationValue(i,i),h=this.getTranslationValue(n,n),N=this.getTranslationValue(s)||void 0,y=this.getTranslationValue(g)||this.getDefaultImage(),d=this.translate.instant(o);d===o&&!a(this.platformId)&&(d=this.getTranslationFromStore(o,e));let U=this.parseStructuredData(d,o),v={title:this.interpolateString(l,r),description:this.interpolateString(h,r),keywords:N||void 0,image:y,url:this.getCurrentUrl(),type:t.type||"website",locale:e,siteName:this.siteName,twitterCard:"summary_large_image",twitterSite:"@bybyte_diy",openGraph:{title:this.interpolateString(l,r),description:this.interpolateString(h,r),image:y,url:this.getCurrentUrl(),type:t.type||"website",siteName:this.siteName,locale:e},structuredData:U};this.updateSeoMeta(v)}generateLessonUrl(t,r,e){let i=this.getCurrentLanguage();return`${this.siteUrl}/${i}/learn/${t}/${r}/${e}`}generateLessonTitle(t){return`${t} - ${this.siteName}`}generateLessonDescription(t,r,e){let i=e.length>0?e.join(", "):"Arduino";return`Learn ${t} with ${this.siteName}. ${r} level lesson for ${i}.`}updateLessonSeo(t,r,e,i){let n=this.generateLessonUrl(r,e,i),s=this.generateLessonTitle(t.title),g=this.generateLessonDescription(t.title,e,t.platforms||[r]),o=t.image||this.getDefaultImage(),l={title:s,description:g,keywords:t.tags?.join(", ")||`${r}, ${e}, robotics, programming`,image:o,url:n,type:"article",locale:this.getCurrentLanguage(),siteName:this.siteName,twitterCard:"summary_large_image",twitterSite:"@bybyte_diy",openGraph:{title:s,description:g,image:o,url:n,type:"article",siteName:this.siteName,locale:this.getCurrentLanguage()},structuredData:this.generateLessonStructuredData(t,r,e,i)};this.updateSeoMeta(l)}updateMetaTag(t,r,e="name"){if(!r)return;let i=`${e}="${t}"`;this.meta.getTag(i)?this.meta.updateTag({[e]:t,content:r},i):this.meta.addTag({[e]:t,content:r})}updateStructuredData(t){if(!a(this.platformId))return;let r=document.querySelector('script[type="application/ld+json"]');r&&r.remove();let e=document.createElement("script");e.type="application/ld+json",e.textContent=JSON.stringify(t),document.head.appendChild(e)}interpolateString(t,r){return r?t.replace(/\{\{(\w+)\}\}/g,(e,i)=>r[i]||e):t}getCurrentUrl(){return a(this.platformId)?window.location.href:this.siteUrl}getCurrentLanguage(){let t="";if(a(this.platformId))t=window.location.pathname;else try{let i=null;try{let{REQUEST:n}=(F(),j(G));i=this.injector.get(n,null)}catch{try{let{REQUEST:s}=b("@nguniversal/express-engine/tokens");i=this.injector.get(s,null)}catch{}}i&&i.url&&typeof i.url=="string"&&(t=i.url)}catch{}let r=I(t);if(r!==p.defaultLang||t&&t.startsWith(`/${r}`))return r;let e=this.translate.getCurrentLang()||this.translate.getFallbackLang()||null;return e&&C(e)?e:p.defaultLang}getDefaultImage(){return`${this.siteUrl}/assets/img/logo.png`}generateLessonStructuredData(t,r,e,i){return{"@context":"https://schema.org","@type":"Article",headline:t.title,description:t.description||this.generateLessonDescription(t.title,e,t.platforms||[r]),image:t.image||this.getDefaultImage(),author:{"@type":"Organization",name:this.siteName,url:this.siteUrl},publisher:{"@type":"Organization",name:this.siteName,logo:{"@type":"ImageObject",url:`${this.siteUrl}/assets/img/logo.png`}},datePublished:t.createdAt||new Date().toISOString(),dateModified:t.updatedAt||new Date().toISOString(),mainEntityOfPage:{"@type":"WebPage","@id":this.generateLessonUrl(r,e,i)},about:{"@type":"Thing",name:`${r} ${e} robotics programming`},educationalLevel:e,learningResourceType:"Tutorial",educationalUse:"instruction"}}static \u0275fac=function(r){return new(r||c)};static \u0275prov=m({token:c,factory:c.\u0275fac,providedIn:"root"})};export{$ as a};
