import{a as K,c as X}from"./chunk-ADZSZRBJ.js";import{a as ee,b as te}from"./chunk-XEJ5JEZK.js";import{c as G,e as H}from"./chunk-7PP3K45Z.js";import{e as J,f as W,g as Y}from"./chunk-JE6XUTR5.js";import{h as y,o as Z,p as S,q as L,r as M}from"./chunk-RMAMC2FW.js";import{Bb as l,Cb as d,Db as w,Ga as i,Gb as v,Hb as f,Nb as q,O as E,T as c,Ta as b,Z as z,_ as $,ab as h,bb as _,db as V,eb as N,fb as B,gb as C,hb as a,ia as j,ib as r,jb as k,pb as U,rb as R,tb as u,wb as A,xb as F,yb as Q}from"./chunk-Q37A7JF6.js";import"./chunk-2VMXMS7J.js";var se=["markdownContainer"];function le(n,t){if(n&1&&(a(0,"span",17),l(1),r()),n&2){let e=t.$implicit;i(),d(e)}}function ce(n,t){if(n&1&&(a(0,"div",13),N(1,le,2,1,"span",17,V),r()),n&2){let e=u(2);i(),B(e.lesson.tags)}}function de(n,t){if(n&1&&(a(0,"div",14)(1,"span",18),l(2),r()()),n&2){let e=u(2);i(2),w("v",e.lesson.version)}}function me(n,t){if(n&1&&(a(0,"div",1)(1,"div",3)(2,"div",4)(3,"div",5)(4,"span",6),l(5),r(),a(6,"span",7),l(7),v(8,"translate"),r()(),a(9,"div",8)(10,"span",9),l(11),r(),a(12,"span",10),l(13),v(14,"translate"),r()()(),a(15,"h1",11),l(16),r(),a(17,"div",12),h(18,ce,3,0,"div",13),h(19,de,3,1,"div",14),r()(),a(20,"div",15,0),k(22,"markdown",16),r()()),n&2){let e=u();i(5),d(e.iconsService.getPlatformIcon(e.lesson.platforms[0])),i(2),d(f(8,8,"lessons.platform."+e.lesson.platforms[0])),i(4),d(e.iconsService.getLevelIcon(e.lesson.level)),i(2),d(f(14,10,"lessons.level."+e.lesson.level)),i(3),d(e.lesson.title),i(2),_(e.lesson.tags&&e.lesson.tags.length?18:-1),i(),_(e.lesson.version?19:-1),i(3),C("data",e.markdownContent)}}function pe(n,t){n&1&&(a(0,"div",2)(1,"p"),l(2),v(3,"translate"),r()()),n&2&&(i(2),d(f(3,1,"lessons.loading")))}var P=class n{lesson=null;markdownContentRef;_sanitizer=c(Y);iconsService=c(te);_contentRendered=!1;markdownContent="";ngOnChanges(t){t.lesson&&this.lesson&&(this.markdownContent=this.extractMarkdownContent(this.lesson.content),this.resetContentRendered())}extractMarkdownContent(t){if(t.startsWith("---")){let e=t.indexOf("---",3);if(e!==-1){let o=t.substring(e+3).trim();return this.processCodeBlocks(o)}}return this.processCodeBlocks(t)}processCodeBlocks(t){let e=/```(\w+)?\s*([\s\S]*?)```/g,o=t.replace(e,(s,m,p)=>m?"```"+this.normalizeLanguage(m.toLowerCase())+`
`+p+"```":"```text\n"+p+"```");return o=this.fixImagePaths(o),o}fixImagePaths(t){let e=/(!\[.*?\]\(|\<img[^>]+src=["'])(\/?content\/)([^"')]+)(["'][^>]*\>|\))/g;return t.replace(e,(s,m,p,g,x)=>m+"assets/content/"+g+x)}normalizeLanguage(t){return{"c++":"cpp",c:"c",arduino:"arduino",js:"javascript",javascript:"javascript",ts:"typescript",typescript:"typescript",html:"markup",xml:"markup",css:"css",scss:"scss",bash:"bash",shell:"bash",sh:"bash",json:"json",md:"markdown",markdown:"markdown"}[t]||t}ngAfterViewChecked(){this.lesson&&!this._contentRendered&&this.markdownContentRef&&(this._contentRendered=!0,setTimeout(()=>{this.markdownContentRef&&typeof window<"u"&&window.Prism&&window.Prism.highlightAll()},500))}resetContentRendered(){this._contentRendered=!1}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=b({type:n,selectors:[["app-lesson-view"]],viewQuery:function(e,o){if(e&1&&A(se,5),e&2){let s;F(s=Q())&&(o.markdownContentRef=s.first)}},inputs:{lesson:"lesson"},features:[j],decls:2,vars:1,consts:[["markdownContainer",""],[1,"lesson-view"],[1,"lesson-loading"],[1,"lesson-header"],[1,"lesson-meta"],[1,"lesson-platform"],[1,"platform-icon"],[1,"platform-name"],[1,"lesson-level"],[1,"level-icon"],[1,"level-name"],[1,"lesson-title"],[1,"lesson-info"],[1,"lesson-tags"],[1,"lesson-version"],[1,"lesson-content"],["lineNumbers","","emoji","",1,"markdown-content",3,"data"],[1,"lesson-tag"],[1,"version-label"]],template:function(e,o){e&1&&h(0,me,23,12,"div",1)(1,pe,4,3,"div",2),e&2&&_(o.lesson?0:1)},dependencies:[y,L,X,K,S],styles:[".lesson-view[_ngcontent-%COMP%]{max-width:900px;margin:0 auto;padding:2rem 1rem}.lesson-header[_ngcontent-%COMP%]{margin-bottom:2rem}.lesson-meta[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1rem}.lesson-platform[_ngcontent-%COMP%], .lesson-level[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:var(--text-sm);color:var(--text-secondary);padding:.25rem .75rem;background:var(--color-surface);border-radius:16px}.platform-icon[_ngcontent-%COMP%], .level-icon[_ngcontent-%COMP%]{font-size:1.2em}.lesson-title[_ngcontent-%COMP%]{font-family:var(--font-display);font-size:var(--text-4xl);font-weight:var(--font-weight-bold);margin-bottom:1rem;color:var(--text-primary);line-height:1.2}.lesson-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.lesson-tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.lesson-tag[_ngcontent-%COMP%]{padding:.25rem .75rem;background:var(--color-bg);border-radius:16px;font-size:var(--text-xs);color:var(--text-secondary)}.lesson-version[_ngcontent-%COMP%]{font-size:var(--text-sm);color:var(--text-secondary)}.lesson-content[_ngcontent-%COMP%]{background:var(--color-surface);border-radius:12px;padding:2rem;box-shadow:0 2px 8px #0000001a}  .markdown-content{line-height:1.6;color:var(--text-primary)}  .markdown-content h1,   .markdown-content h2,   .markdown-content h3,   .markdown-content h4,   .markdown-content h5,   .markdown-content h6{margin-top:1.5em;margin-bottom:.75em;font-family:var(--font-display);font-weight:var(--font-weight-bold);color:var(--text-primary)}  .markdown-content h1{font-size:var(--text-3xl)}  .markdown-content h2{font-size:var(--text-2xl)}  .markdown-content h3{font-size:var(--text-xl)}  .markdown-content p{margin-bottom:1.5em}  .markdown-content ul,   .markdown-content ol{margin-bottom:1.5em;padding-left:1.5em}  .markdown-content li{margin-bottom:.5em}  .markdown-content code:not([class*=language-]){font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;background:var(--color-bg);padding:.2em .4em;border-radius:3px;font-size:.9em}  .markdown-content pre{padding:0;margin-bottom:1.5em;border-radius:8px;overflow:auto;scrollbar-width:auto;scrollbar-color:rgba(0,0,0,.2) transparent}  .markdown-content pre::-webkit-scrollbar{width:8px;height:8px}  .markdown-content pre::-webkit-scrollbar-track{background:transparent}  .markdown-content pre::-webkit-scrollbar-thumb{background:#0003;border-radius:4px;opacity:0;transition:opacity .3s ease}  .markdown-content pre::-webkit-scrollbar-thumb:hover{background:#0006}  .markdown-content pre:hover::-webkit-scrollbar-thumb{opacity:1}  .markdown-content pre code{background:transparent;padding:0}  .markdown-content pre[class*=language-]{position:relative;margin:1em 0;border-radius:8px;box-shadow:0 2px 8px #0000001a}  .markdown-content .line-numbers .line-numbers-rows{padding:1em 0}  .markdown-content div.code-toolbar>.toolbar{top:.3em;right:.3em;transition:opacity .3s ease}  .markdown-content div.code-toolbar>.toolbar button{cursor:pointer}  .markdown-content img{max-width:100%;height:auto;border-radius:8px;margin:1.5em 0}  .markdown-content blockquote{border-left:4px solid var(--color-primary);padding-left:1em;margin-left:0;margin-right:0;font-style:italic;color:var(--text-secondary)}  .markdown-content table{width:100%;border-collapse:collapse;margin-bottom:1.5em}  .markdown-content table th,   .markdown-content table td{border:1px solid var(--color-border);padding:.5em;text-align:left}  .markdown-content table th{background:var(--color-bg);font-weight:var(--font-weight-medium)}  .markdown-content pre[class*=language-]{text-shadow:none}.lesson-loading[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:300px}.lesson-loading[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:var(--text-lg);color:var(--text-secondary)}@media (max-width: 768px){.lesson-title[_ngcontent-%COMP%]{font-size:var(--text-3xl)}.lesson-content[_ngcontent-%COMP%]{padding:1.5rem}}"]})};var O=class n{get siteName(){return M.siteName}get siteUrl(){return M.siteUrl}get siteDescription(){return M.siteDescription}generateLessonUrl(t,e,o){return`${this.siteUrl}/learn/${t}/${e}/${o}`}generateLessonTitle(t){return`${t} - ${this.siteName}`}generateLessonDescription(t,e,o){let s=o.length>0?o.join(", "):"Arduino";return`Learn ${t} with ${this.siteName}. ${e} level lesson for ${s}.`}static \u0275fac=function(e){return new(e||n)};static \u0275prov=E({token:n,factory:n.\u0275fac,providedIn:"root"})};function ge(n,t){if(n&1){let e=U();a(0,"div",4)(1,"p",5),l(2),r(),a(3,"button",2),R("click",function(){z(e);let s=u();return $(s.goBack())}),l(4),v(5,"translate"),r()()}if(n&2){let e=u();i(2),d(e.lessonsService.error()),i(2),w(" \u2190 ",f(5,2,"lessons.backToList")," ")}}var oe=class n{lessonsService=c(ee);_route=c(G);_router=c(H);_translate=c(Z);_meta=c(J);_title=c(W);_seoService=c(O);_paramMapSubscription;constructor(){q(()=>{let t=this.lessonsService.currentLesson();t&&this._updateSEOTags(t)})}ngOnInit(){this.lessonsService.lessonsIndex()?this._loadLesson():this.lessonsService.loadLessonsIndex().subscribe(()=>{this._loadLesson()})}goBack(){this._router.navigate(["/learn"])}ngOnDestroy(){this._paramMapSubscription&&this._paramMapSubscription.unsubscribe()}_loadLesson(){this._paramMapSubscription=this._route.paramMap.subscribe(t=>{let e=t.get("slug"),o=t.get("platform"),s=t.get("level");if(!e||!o||!s){this._router.navigate(["/learn"]);return}let m=this._translate.currentLang||this._translate.defaultLang||"";this.lessonsService.loadLesson(e,m,o).subscribe()})}_updateSEOTags(t){let e=t.platforms||[],o=t.tags||[],s=e[0]||"arduino",m=e.length>0?e.join(", "):"Arduino",p=this._seoService.generateLessonTitle(t.title),g=t.description||this._seoService.generateLessonDescription(t.title,t.level,e),x=o.length>0?o.join(", "):`${t.title}, ${t.level}, ${m}`,T=this._seoService.generateLessonUrl(s,t.level,t.slug);this._title.setTitle(p),this._meta.updateTag({name:"description",content:g}),this._meta.updateTag({name:"keywords",content:x}),this._meta.updateTag({name:"author",content:this._seoService.siteName}),this._meta.updateTag({name:"robots",content:"index, follow"}),this._meta.updateTag({name:"viewport",content:"width=device-width, initial-scale=1"}),this._meta.updateTag({name:"theme-color",content:"#2563eb"}),this._meta.updateTag({property:"og:title",content:p}),this._meta.updateTag({property:"og:description",content:g}),this._meta.updateTag({property:"og:url",content:T}),this._meta.updateTag({property:"og:type",content:"article"}),this._meta.updateTag({property:"og:site_name",content:this._seoService.siteName}),this._meta.updateTag({property:"og:locale",content:t.lang==="uk"?"uk_UA":t.lang==="ru"?"ru_RU":"en_US"}),this._meta.updateTag({name:"twitter:card",content:"summary_large_image"}),this._meta.updateTag({name:"twitter:title",content:p}),this._meta.updateTag({name:"twitter:description",content:g}),this._meta.updateTag({name:"twitter:site",content:"@ByByteDIY"});let ie={"@context":"https://schema.org","@type":"LearningResource",name:t.title,description:g,educationalLevel:t.level,learningResourceType:"Lesson",inLanguage:t.lang,keywords:x,url:T,isPartOf:{"@type":"Course",name:`${this._seoService.siteName} ${s} Course`,description:`Learn ${s} programming with ${this._seoService.siteName}`},provider:{"@type":"Organization",name:this._seoService.siteName,url:this._seoService.siteUrl,logo:`${this._seoService.siteUrl}/assets/logo.png`},audience:{"@type":"EducationalAudience",educationalRole:"student"}},D=document.querySelector('script[type="application/ld+json"]');D&&D.remove();let I=document.createElement("script");I.type="application/ld+json",I.textContent=JSON.stringify(ie),document.head.appendChild(I)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=b({type:n,selectors:[["app-lesson-detail-page"]],decls:7,vars:5,consts:[[1,"lesson-detail-page"],[1,"lesson-detail-page__nav"],[1,"back-button",3,"click"],[3,"lesson"],[1,"lesson-detail-page__error"],[1,"error-message"]],template:function(e,o){e&1&&(a(0,"div",0)(1,"div",1)(2,"button",2),R("click",function(){return o.goBack()}),l(3),v(4,"translate"),r()(),k(5,"app-lesson-view",3),h(6,ge,6,4,"div",4),r()),e&2&&(i(3),w(" \u2190 ",f(4,3,"lessons.backToList")," "),i(2),C("lesson",o.lessonsService.currentLesson()),i(),_(o.lessonsService.error()?6:-1))},dependencies:[y,L,P,S],styles:[".lesson-detail-page[_ngcontent-%COMP%]{padding:2rem 1rem}.lesson-detail-page__nav[_ngcontent-%COMP%]{max-width:900px;margin:0 auto 1rem}.back-button[_ngcontent-%COMP%]{background:none;border:none;color:var(--color-primary);font-size:var(--text-base);cursor:pointer;padding:.5rem 0}.back-button[_ngcontent-%COMP%]:hover{text-decoration:underline}.lesson-detail-page__error[_ngcontent-%COMP%]{max-width:900px;margin:2rem auto;padding:2rem;background:var(--color-surface);border-radius:12px;text-align:center;box-shadow:0 2px 8px #0000001a}.lesson-detail-page__error[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{font-size:var(--text-lg);color:var(--color-error);margin-bottom:1.5rem}"]})};export{oe as LessonDetailPageComponent};
