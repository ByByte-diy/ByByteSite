import{Fa as m,G as L,Ja as a,La as G,R as M,Sa as I,Ta as N,Xa as P,gb as C,jb as l,kb as $,lb as v,nb as k,ob as x,p as T,q as S,t as p,u as w}from"./chunk-IMSOYEQO.js";import{c as O,h as F}from"./chunk-ASRB7XND.js";m();P();G();m();var d=class g{meta=p(I);title=p(N);translate=p(C);platformId=p(L);injector=p(w);get siteName(){return l.siteName}get siteUrl(){return l.siteUrl}get siteDescription(){return l.siteDescription}updateSeoMeta(t){this.title.setTitle(t.title),this.updateMetaTag("description",t.description),this.updateMetaTag("keywords",t.keywords),this.updateMetaTag("author",t.author),this.updateMetaTag("og:title",t.openGraph?.title||t.title,"property"),this.updateMetaTag("og:description",t.openGraph?.description||t.description,"property"),this.updateMetaTag("og:image",t.openGraph?.image||t.image,"property"),this.updateMetaTag("og:url",t.openGraph?.url||t.url,"property"),this.updateMetaTag("og:type",t.openGraph?.type||t.type,"property"),this.updateMetaTag("og:site_name",t.openGraph?.siteName||t.siteName,"property"),this.updateMetaTag("og:locale",t.openGraph?.locale||t.locale,"property"),this.updateMetaTag("twitter:card",t.twitterCard),this.updateMetaTag("twitter:site",t.twitterSite),this.updateMetaTag("twitter:creator",t.twitterCreator),this.updateMetaTag("twitter:title",t.title),this.updateMetaTag("twitter:description",t.description),this.updateMetaTag("twitter:image",t.image),t.structuredData&&a(this.platformId)&&this.updateStructuredData(t.structuredData)}getTranslationFromStore(t,e){if(a(this.platformId))return null;try{let r=this.translate.store;if(!r?.translations?.[e])return null;let i=r.translations[e],n=t.split("."),s=i;for(let u of n)if(s=s?.[u],s==null)return null;return s}catch{return null}}getTranslationValue(t,e){let r=this.translate.instant(t);if(r===t&&!a(this.platformId)){let i=this.getCurrentLanguage(),n=this.getTranslationFromStore(t,i);n!==null&&(r=n)}return r===t||!r?e!==void 0?e:t:typeof r=="string"?r:e!==void 0?e:t}parseStructuredData(t,e){if(!(!t||t===e)){if(typeof t=="object")return t;if(typeof t=="string")try{return JSON.parse(t)}catch{return}}}updateSeoFromConfig(t,e){let r=this.getCurrentLanguage(),i=t.titleKey||"seo.home.title",n=t.descriptionKey||"seo.home.description",s=t.keywordsKey||"seo.home.keywords",u=t.imageKey||"seo.home.image",o=t.structuredDataKey||"seo.home.structuredData",c=this.getTranslationValue(i,i),y=this.getTranslationValue(n,n),b=this.getTranslationValue(s)||void 0,f=this.getTranslationValue(u)||this.getDefaultImage(),h=this.translate.instant(o);h===o&&!a(this.platformId)&&(h=this.getTranslationFromStore(o,r));let j=this.parseStructuredData(h,o),K={title:this.interpolateString(c,e),description:this.interpolateString(y,e),keywords:b||void 0,image:f,url:this.getCurrentUrl(),type:t.type||"website",locale:r,siteName:this.siteName,twitterCard:"summary_large_image",twitterSite:"@bybyte_diy",openGraph:{title:this.interpolateString(c,e),description:this.interpolateString(y,e),image:f,url:this.getCurrentUrl(),type:t.type||"website",siteName:this.siteName,locale:r},structuredData:j};this.updateSeoMeta(K)}generateLessonUrl(t,e,r){let i=this.getCurrentLanguage();return`${this.siteUrl}/${i}/learn/${t}/${e}/${r}`}generateLessonTitle(t){return`${t} - ${this.siteName}`}generateLessonDescription(t,e,r){let i=r.length>0?r.join(", "):"Arduino";return`Learn ${t} with ${this.siteName}. ${e} level lesson for ${i}.`}updateLessonSeo(t,e,r,i){let n=this.generateLessonUrl(e,r,i),s=this.generateLessonTitle(t.title),u=this.generateLessonDescription(t.title,r,t.platforms||[e]),o=t.image||this.getDefaultImage(),c={title:s,description:u,keywords:t.tags?.join(", ")||`${e}, ${r}, robotics, programming`,image:o,url:n,type:"article",locale:this.getCurrentLanguage(),siteName:this.siteName,twitterCard:"summary_large_image",twitterSite:"@bybyte_diy",openGraph:{title:s,description:u,image:o,url:n,type:"article",siteName:this.siteName,locale:this.getCurrentLanguage()},structuredData:this.generateLessonStructuredData(t,e,r,i)};this.updateSeoMeta(c)}updateMetaTag(t,e,r="name"){if(!e)return;let i=`${r}="${t}"`;this.meta.getTag(i)?this.meta.updateTag({[r]:t,content:e},i):this.meta.addTag({[r]:t,content:e})}updateStructuredData(t){if(!a(this.platformId))return;let e=document.querySelector('script[type="application/ld+json"]');e&&e.remove();let r=document.createElement("script");r.type="application/ld+json",r.textContent=JSON.stringify(t),document.head.appendChild(r)}interpolateString(t,e){return e?t.replace(/\{\{(\w+)\}\}/g,(r,i)=>e[i]||r):t}getCurrentUrl(){return a(this.platformId)?window.location.href:this.siteUrl}getCurrentLanguage(){let t="";if(a(this.platformId))t=window.location.pathname;else try{let i=null;try{let{REQUEST:n}=(x(),F(k));i=this.injector.get(n,null)}catch{try{let{REQUEST:s}=O("@nguniversal/express-engine/tokens");i=this.injector.get(s,null)}catch{}}i&&i.url&&typeof i.url=="string"&&(t=i.url)}catch{}let e=$(t);if(e!==l.defaultLang||t&&t.startsWith(`/${e}`))return e;let r=this.translate.getCurrentLang()||this.translate.getFallbackLang()||null;return r&&v(r)?r:l.defaultLang}getDefaultImage(){return`${this.siteUrl}/assets/img/logo.png`}generateLessonStructuredData(t,e,r,i){return{"@context":"https://schema.org","@type":"Article",headline:t.title,description:t.description||this.generateLessonDescription(t.title,r,t.platforms||[e]),image:t.image||this.getDefaultImage(),author:{"@type":"Organization",name:this.siteName,url:this.siteUrl},publisher:{"@type":"Organization",name:this.siteName,logo:{"@type":"ImageObject",url:`${this.siteUrl}/assets/img/logo.png`}},datePublished:t.createdAt||new Date().toISOString(),dateModified:t.updatedAt||new Date().toISOString(),mainEntityOfPage:{"@type":"WebPage","@id":this.generateLessonUrl(e,r,i)},about:{"@type":"Thing",name:`${e} ${r} robotics programming`},educationalLevel:r,learningResourceType:"Tutorial",educationalUse:"instruction"}}static \u0275fac=function(e){return new(e||g)};static \u0275prov=T({token:g,factory:g.\u0275fac})};m();var U=class g{static \u0275fac=function(e){return new(e||g)};static \u0275mod=M({type:g});static \u0275inj=S({providers:[d]})};export{d as a,U as b};
